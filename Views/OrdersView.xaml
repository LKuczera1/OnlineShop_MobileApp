<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="OnlineShop_MobileApp.Views.OrdersView">

    <Grid BackgroundColor="{DynamicResource BackgroundColor}">

        <Label IsVisible="{Binding IsNoOrderVisible}"
               Text="You haven't placed any orders yet."
               HorizontalOptions="Center"
               VerticalOptions="Center" 
               FontSize="20"/>


        <Label IsVisible="{Binding IsUserNotLoggedInVisible}"
               Text="Please log in to see this content"
               HorizontalOptions="Center"
               VerticalOptions="Center"  
               FontSize="20"/>



        <CollectionView ItemsSource="{Binding Items}"
                        IsVisible="{Binding IsOrderPageVisible}"
                        HorizontalScrollBarVisibility="Never"
                        VerticalScrollBarVisibility="Never">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="0"
                          VerticalOptions="Start">

                        <Border class="CollectionItemBorder">
                            <Grid ColumnDefinitions="*,auto">

                                <VerticalStackLayout Grid.Column="0"
                                                     HorizontalOptions="Start">
                                    <Label>
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="Order number: " />
                                                <Span Text="{Binding OrderId}" />


                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Label>
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="Total price: " />
                                                <Span Text="{Binding TotalPrice, StringFormat='{0:0.00}'}" />
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <VerticalStackLayout IsVisible="{Binding AreDetailsVisible}">
                                        
                                        <Label
                                               LineBreakMode="WordWrap"
                                               Margin="0,10,0,10">
                                            <Label.FormattedText>
                                                <FormattedString>
                                                    <Span Text="OrderStatus: " />
                                                    <Span Text="{Binding OrderStatusString}" />
                                                </FormattedString>
                                            </Label.FormattedText>
                                        </Label>

                                        <Label>
                                            <Label.FormattedText>
                                                <FormattedString>
                                                    <Span Text="Ordered time: " />
                                                    <Span Text="{Binding OrderTime}" />
                                                </FormattedString>
                                            </Label.FormattedText>
                                        </Label>
                                        
                                        <Label>
                                            <Label.FormattedText>
                                                <FormattedString>
                                                    <Span Text="Packed time: " />
                                                    <Span Text="{Binding PackedTime}" />
                                                </FormattedString>
                                            </Label.FormattedText>
                                        </Label>

                                        <Label>
                                            <Label.FormattedText>
                                                <FormattedString>
                                                    <Span Text="Send time: " />
                                                    <Span Text="{Binding SendTime}" />
                                                </FormattedString>
                                            </Label.FormattedText>
                                        </Label>


                                        <Label>
                                            <Label.FormattedText>
                                                <FormattedString>
                                                    <Span Text="Delivered time: " />
                                                    <Span Text="{Binding DeliveredTime}" />
                                                </FormattedString>
                                            </Label.FormattedText>
                                        </Label>

                                    </VerticalStackLayout>

                                </VerticalStackLayout>

                                <Button Grid.Column="1"
                                        Text="OrderDetails"
                                        MaximumWidthRequest="120"
                                        HorizontalOptions="End"
                                        VerticalOptions="Start"
                                        MaximumHeightRequest="80"
                                        Command="{Binding BindingContext.ChangeOrderDetailsVisiblity, Source={RelativeSource AncestorType={x:Type ContentView}}}"
                                        CommandParameter="{Binding .}">
                                    
                                </Button>

                            </Grid>

                        </Border>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>

</ContentView>